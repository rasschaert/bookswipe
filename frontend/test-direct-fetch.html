<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test Direct Fetch API</title>
  </head>
  <body>
    <h1>Test Direct Fetch API</h1>
    <div id="status">Testing...</div>
    <div id="console"></div>

    <script src="scripts/api-fetch.js"></script>
    <script>
      const logElement = document.getElementById("console");
      const statusElement = document.getElementById("status");

      function log(message) {
        console.log(message);
        logElement.innerHTML += `<p>${message}</p>`;
      }

      function setStatus(message) {
        statusElement.textContent = message;
      }

      async function testDirectFetchAPI() {
        try {
          setStatus("Initializing direct fetch API...");

          await bookSwipeAPI.init();
          log("✅ API initialized");

          setStatus("Testing connection...");
          await bookSwipeAPI.testConnection();
          log("✅ Connection test passed");

          setStatus("Loading books...");
          const books = await bookSwipeAPI.getBooks();
          log(`✅ Loaded ${books.length} books`);

          if (books.length > 0) {
            log(`First book: ${books[0].title} by ${books[0].author}`);
            log(`Genre tags: ${JSON.stringify(books[0].genre_tags)}`);
          }

          setStatus(`✅ Success! Loaded ${books.length} books`);
        } catch (error) {
          log(`❌ Error: ${error.message}`);
          log(`Stack: ${error.stack}`);
          setStatus(`❌ Failed: ${error.message}`);
        }
      }

      testDirectFetchAPI();
    </script>
  </body>
</html>
